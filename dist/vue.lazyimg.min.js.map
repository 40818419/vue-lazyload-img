{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///vue.lazyimg.min.js","webpack:///webpack/bootstrap 8b012593cff3135eca09","webpack:///./src/index.ts","webpack:///./src/scrollEnd.ts","webpack:///./src/Set.ts"],"names":["root","factory","exports","module","define","amd","self","this","modules","__webpack_require__","moduleId","installedModules","i","l","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","object","property","prototype","hasOwnProperty","p","s","scrollEnd_1","Set_1","scrollListeners","scrollEndListeners","window","addEventListener","e","forEach","listener","compute","el","time","cb","rect","getBoundingClientRect","bottom","screen","height","top","right","width","left","src","newSrc","onload","style","opacity","__scrollListener__","__scrollEndListener__","transition","getSpeed","_a","lastPos","lastSpeeds","aveSpeed","clientRect","document","body","curPos","speed","length","push","shift","sumSpeed","Math","abs","compareSrc","replace","match","Lazyload","install","Vue","_b","_c","fade","_d","directive","inserted","binding","vnode","oldVnode","onError","removeEventListener","computeBySpeed","onScrollEnd","value","speedInfo","add","update","setTimeout","default_1","enterFrame","cntr","lastCntr","diff","dispatchEvent","scrollEnd","requestAnimationFrame","createEvent","initEvent","eventType","webkitRequestAnimationFrame","cid","Set","_map","obj","__cid__","key"],"mappings":"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","file":"vue.lazyimg.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Lazyload\"] = factory();\n\telse\n\t\troot[\"Lazyload\"] = factory();\n})(typeof self !== 'undefined' ? self : this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Lazyload\"] = factory();\n\telse\n\t\troot[\"Lazyload\"] = factory();\n})(typeof self !== 'undefined' ? self : this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nexports.__esModule = true;\r\nvar scrollEnd_1 = __webpack_require__(1);\r\nvar Set_1 = __webpack_require__(2);\r\nvar scrollListeners = new Set_1[\"default\"];\r\nvar scrollEndListeners = new Set_1[\"default\"];\r\nwindow.addEventListener('scroll', function (e) {\r\n    scrollListeners.forEach(function (listener) {\r\n        listener();\r\n    });\r\n}, true);\r\nwindow.addEventListener('scrollEnd', function (e) {\r\n    scrollEndListeners.forEach(function (listener) {\r\n        listener();\r\n    });\r\n}, true);\r\nvar compute = function (el, time, cb) {\r\n    if (cb === void 0) { cb = function () { }; }\r\n    var rect = el.getBoundingClientRect();\r\n    if (((rect.bottom >= 0 && rect.bottom <= window.screen.height)\r\n        || (rect.top >= 0 && rect.top <= window.screen.height))\r\n        && ((rect.right >= 0 && rect.right <= window.screen.width)\r\n            || (rect.left >= 0 && rect.left <= window.screen.width))) {\r\n        if (el.src != el.newSrc && !!el.newSrc) {\r\n            el.src = el.newSrc;\r\n            el.onload = function () {\r\n                el.style.opacity = '1';\r\n                el.onload = function () { };\r\n                scrollListeners[\"delete\"](el.__scrollListener__);\r\n                scrollEndListeners[\"delete\"](el.__scrollEndListener__);\r\n                el.__scrollListener__ = null;\r\n                el.__scrollEndListener__ = null;\r\n            };\r\n            el.style.transition = \"opacity \" + time + \"ms\";\r\n            if (cb) {\r\n                cb();\r\n            }\r\n        }\r\n    }\r\n};\r\nvar getSpeed = function (_a) {\r\n    var lastPos = _a.lastPos, lastSpeeds = _a.lastSpeeds, aveSpeed = _a.aveSpeed;\r\n    var clientRect = document.body.getBoundingClientRect();\r\n    var curPos = clientRect.top;\r\n    var speed = lastPos - curPos;\r\n    if (lastSpeeds.length < 10) {\r\n        lastSpeeds.push(speed);\r\n    }\r\n    else {\r\n        lastSpeeds.shift();\r\n        lastSpeeds.push(speed);\r\n    }\r\n    var sumSpeed = 0;\r\n    lastSpeeds.forEach(function (speed) {\r\n        sumSpeed += speed;\r\n    });\r\n    aveSpeed = Math.abs(sumSpeed / lastSpeeds.length);\r\n    lastPos = curPos;\r\n    return {\r\n        lastPos: lastPos,\r\n        lastSpeeds: lastSpeeds,\r\n        aveSpeed: aveSpeed\r\n    };\r\n};\r\nvar compareSrc = function (src, newSrc) {\r\n    if (src.replace(/^http:/, '').replace(/^https:/, '').match(newSrc.replace(/^http:/, '').replace(/^https:/, ''))) {\r\n        return true;\r\n    }\r\n    else\r\n        return false;\r\n};\r\nvar Lazyload = {\r\n    install: function (Vue, _a) {\r\n        var _b = _a.time, time = _b === void 0 ? 300 : _b, _c = _a.fade, fade = _c === void 0 ? false : _c, _d = _a.speed, speed = _d === void 0 ? 0 : _d;\r\n        if (speed > 0)\r\n            scrollEnd_1[\"default\"]();\r\n        Vue.directive('lazyload', {\r\n            inserted: function (el, binding, vnode, oldVnode) {\r\n                if (!el)\r\n                    return;\r\n                if (compareSrc(el.src, binding.value))\r\n                    return;\r\n                if (fade)\r\n                    el.style.opacity = '0';\r\n                if (!el.src) {\r\n                    el.src = 'data:image/gifbase64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==';\r\n                }\r\n                var speedInfo = {\r\n                    lastPos: document.body.getBoundingClientRect().top,\r\n                    lastSpeeds: [],\r\n                    aveSpeed: 0\r\n                };\r\n                el.newSrc = binding.value;\r\n                var computeBySpeed = function () {\r\n                    if (!el.newSrc || el.newSrc === el.src)\r\n                        return;\r\n                    if (speed == 0) {\r\n                        compute(el, time);\r\n                        return;\r\n                    }\r\n                    speedInfo = getSpeed(speedInfo);\r\n                    if (speedInfo.aveSpeed > speed)\r\n                        return;\r\n                    compute(el, time);\r\n                };\r\n                var onScrollEnd = function () {\r\n                    if (!el.newSrc || el.newSrc === el.src)\r\n                        return;\r\n                    compute(el, time);\r\n                };\r\n                el.__scrollListener__ = computeBySpeed;\r\n                el.__scrollEndListener__ = onScrollEnd;\r\n                el.onload = function () {\r\n                    el.onload = function () { };\r\n                    el.removeEventListener('error', onError);\r\n                    compute(el, time);\r\n                    scrollListeners.add(computeBySpeed);\r\n                    if (speed > 0)\r\n                        scrollEndListeners.add(onScrollEnd);\r\n                };\r\n                function onError() {\r\n                    el.onload = function () { };\r\n                    el.removeEventListener('error', onError);\r\n                    scrollListeners[\"delete\"](computeBySpeed);\r\n                    scrollEndListeners[\"delete\"](onScrollEnd);\r\n                }\r\n                el.addEventListener('error', onError);\r\n            },\r\n            update: function (el, binding) {\r\n                if (compareSrc(el.src, binding.value))\r\n                    return;\r\n                el.style.opacity = '0';\r\n                el.style.transition = \"opacity \" + time / 2 + \"ms\";\r\n                el.newSrc = binding.value;\r\n                setTimeout(function () {\r\n                    compute(el, time / 2);\r\n                }, 150);\r\n            }\r\n        });\r\n    }\r\n};\r\nexports[\"default\"] = Lazyload;\r\n\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nexports.__esModule = true;\r\nif (!window.requestAnimationFrame) {\r\n    if (window.webkitRequestAnimationFrame) {\r\n        window.requestAnimationFrame = window.webkitRequestAnimationFrame;\r\n    }\r\n    else {\r\n        window.requestAnimationFrame = function requestAnimationFrame(cb) {\r\n            setTimeout(function () {\r\n                cb(0);\r\n            }, 1000 / 60);\r\n            return 0;\r\n        };\r\n    }\r\n}\r\nfunction default_1() {\r\n    var cntr = 0;\r\n    var lastCntr = 0;\r\n    var diff = 0;\r\n    var scrollEnd = document.createEvent('HTMLEvents');\r\n    scrollEnd.initEvent('scrollEnd', true, false);\r\n    scrollEnd.eventType = 'message';\r\n    function enterFrame() {\r\n        if (cntr !== lastCntr) {\r\n            diff++;\r\n            if (diff === 5) {\r\n                window.dispatchEvent(scrollEnd);\r\n                cntr = lastCntr;\r\n            }\r\n        }\r\n        requestAnimationFrame(enterFrame);\r\n    }\r\n    window.requestAnimationFrame(enterFrame);\r\n    window.addEventListener('scroll', function () {\r\n        lastCntr = cntr;\r\n        diff = 0;\r\n        cntr++;\r\n    });\r\n}\r\nexports[\"default\"] = default_1;\r\n\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nexports.__esModule = true;\r\nvar cid = 0;\r\nvar Set = (function () {\r\n    function Set() {\r\n        this._map = {};\r\n    }\r\n    Set.prototype.add = function (obj) {\r\n        obj.__cid__ = cid;\r\n        cid++;\r\n        this._map[obj.__cid__] = obj;\r\n    };\r\n    Set.prototype[\"delete\"] = function (obj) {\r\n        if (obj && obj.__cid__ && this._map.hasOwnProperty(obj.__cid__))\r\n            delete this._map[obj.__cid__];\r\n    };\r\n    Set.prototype.forEach = function (cb) {\r\n        for (var key in this._map) {\r\n            if (this._map.hasOwnProperty(key)) {\r\n                cb(this._map[key]);\r\n            }\r\n        }\r\n    };\r\n    return Set;\r\n}());\r\nexports[\"default\"] = Set;\r\n\n\n/***/ })\n/******/ ]);\n});\n\n\n// WEBPACK FOOTER //\n// vue.lazyimg.min.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 8b012593cff3135eca09","import Vue, { PluginObject, VNode, PluginFunction, VNodeDirective, VueConstructor} from 'vue/types'\r\n\r\nimport ImageElement from './ImageElement'\r\n\r\nimport scrollEnd from './scrollEnd'\r\nimport Set from './Set'\r\n\r\nconst scrollListeners = new Set\r\nconst scrollEndListeners = new Set\r\n\r\nwindow.addEventListener('scroll', function (e: UIEvent) {\r\n    scrollListeners.forEach((listener: Function) => {\r\n        listener()\r\n    })\r\n}, true)\r\n\r\nwindow.addEventListener('scrollEnd', function (e: UIEvent) {\r\n    scrollEndListeners.forEach((listener: Function) => {\r\n        listener()\r\n    })\r\n}, true)\r\n\r\nconst compute = function(el: ImageElement, time: number, cb = function(){}) {\r\n    const rect = el.getBoundingClientRect()\r\n    if(((rect.bottom >=0 && rect.bottom <= window.screen.height) \r\n        || (rect.top >=0 && rect.top <= window.screen.height))\r\n    && ((rect.right >=0 && rect.right <= window.screen.width) \r\n        || (rect.left >=0 && rect.left <= window.screen.width))) {\r\n        if(el.src != el.newSrc && !!el.newSrc){\r\n            el.src = el.newSrc\r\n            el.onload = function(){\r\n                el.style.opacity = '1'\r\n                el.onload = function(){}\r\n                scrollListeners.delete(el.__scrollListener__)\r\n                scrollEndListeners.delete(el.__scrollEndListener__)\r\n                el.__scrollListener__ = null\r\n                el.__scrollEndListener__ = null\r\n            }\r\n            el.style.transition = `opacity ${time}ms`\r\n            if(cb){\r\n                cb()\r\n            }\r\n        }\r\n    }\r\n}\r\ntype getSpeedArgs =  {\r\n    lastPos: number,\r\n    lastSpeeds: Array<number>,\r\n    aveSpeed: number,\r\n}\r\nconst getSpeed = function({\r\n    lastPos,\r\n    lastSpeeds,\r\n    aveSpeed,\r\n} : getSpeedArgs) {\r\n    const clientRect = document.body.getBoundingClientRect()\r\n    const curPos = clientRect.top\r\n    // const curPos = document.body.getBoundingClientRect().top\r\n    let speed = lastPos - curPos\r\n    if(lastSpeeds.length<10){\r\n        lastSpeeds.push(speed)\r\n    }else{\r\n        lastSpeeds.shift()\r\n        lastSpeeds.push(speed)\r\n    }\r\n    let sumSpeed = 0\r\n    lastSpeeds.forEach(function(speed: number){\r\n        sumSpeed += speed\r\n    })\r\n    aveSpeed = Math.abs(sumSpeed/lastSpeeds.length)\r\n    lastPos = curPos\r\n    return {\r\n        lastPos,\r\n        lastSpeeds,\r\n        aveSpeed\r\n    }\r\n}\r\nconst compareSrc = function(src: string, newSrc: string) {\r\n    if(src.replace(/^http:/,'').replace(/^https:/,'').match(newSrc.replace(/^http:/,'').replace(/^https:/,''))){\r\n        return true\r\n    }else return false\r\n}\r\ntype Options = {\r\n    time: number,\r\n    fade: boolean,\r\n    speed: number,\r\n}\r\nconst Lazyload:PluginObject<Options> = {\r\n    install: (Vue: VueConstructor, {\r\n        time = 300,\r\n        fade = false,\r\n        speed = 0,\r\n    }: Options) => {\r\n        if (speed > 0)\r\n            scrollEnd()\r\n        Vue.directive('lazyload', {\r\n            inserted (el: ImageElement, binding: VNodeDirective, vnode: VNode, oldVnode: VNode) {\r\n                if (!el) return\r\n                if (compareSrc(el.src, binding.value)) return\r\n                if (fade)\r\n                    el.style.opacity = '0'\r\n                if (!el.src) {\r\n                    el.src = 'data:image/gifbase64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=='\r\n                }\r\n                let speedInfo = {\r\n                    lastPos: document.body.getBoundingClientRect().top,\r\n                    lastSpeeds: [],\r\n                    aveSpeed: 0,\r\n                } as getSpeedArgs\r\n                el.newSrc = binding.value\r\n                const computeBySpeed = function () {\r\n                    if(!el.newSrc || el.newSrc === el.src)return\r\n                    if (speed == 0) {\r\n                        compute(el, time) \r\n                        return\r\n                    }\r\n                    speedInfo = getSpeed(speedInfo)\r\n                    if(speedInfo.aveSpeed > speed)return\r\n                    compute(el, time)\r\n                }\r\n                const onScrollEnd = function(){\r\n                    if(!el.newSrc || el.newSrc === el.src)return\r\n                    compute(el, time)\r\n                }\r\n                el.__scrollListener__  = computeBySpeed\r\n                el.__scrollEndListener__ = onScrollEnd\r\n                el.onload = function() {\r\n                    el.onload = function(){}\r\n                    el.removeEventListener('error', onError)\r\n                    compute(el, time)\r\n                    scrollListeners.add(computeBySpeed)\r\n                    if (speed > 0)\r\n                        scrollEndListeners.add(onScrollEnd)\r\n                }\r\n                function onError () {\r\n                    el.onload = function(){}\r\n                    el.removeEventListener('error', onError)\r\n                    scrollListeners.delete(computeBySpeed)\r\n                    scrollEndListeners.delete(onScrollEnd)\r\n                }\r\n                el.addEventListener('error', onError)\r\n                // setTimeout(function(){\r\n                //     compute(el, time)\r\n                // })\r\n            },\r\n            update (el: ImageElement, binding: VNodeDirective) {\r\n                if(compareSrc(el.src,binding.value))return\r\n                el.style.opacity = '0'\r\n                el.style.transition = `opacity ${time/2}ms`\r\n                el.newSrc = binding.value\r\n                setTimeout(() => {\r\n                    compute(el, time/2)\r\n                }, 150)\r\n            },\r\n        })\r\n    }\r\n}\r\n\r\nexport default Lazyload\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.ts","import ScrollEvent from './ScrollEvent'\r\n\r\nif (!window.requestAnimationFrame) {\r\n    if (window.webkitRequestAnimationFrame) {\r\n        window.requestAnimationFrame = window.webkitRequestAnimationFrame\r\n    } else {\r\n        window.requestAnimationFrame = function requestAnimationFrame (cb) {\r\n            setTimeout(function () {\r\n                cb(0)\r\n            }, 1000 / 60)\r\n            return 0\r\n        }\r\n    }\r\n}\r\nexport default function(){\r\n    let cntr = 0\r\n    let lastCntr = 0\r\n    let diff = 0\r\n    const scrollEnd = document.createEvent('HTMLEvents') as ScrollEvent;\r\n    scrollEnd.initEvent('scrollEnd',true, false);\r\n    scrollEnd.eventType = 'message';\r\n    function enterFrame(){\r\n        if(cntr !== lastCntr){\r\n            diff++\r\n            if(diff === 5){\r\n                window.dispatchEvent(scrollEnd);\r\n                cntr = lastCntr;\r\n            }\r\n        }\r\n        requestAnimationFrame(enterFrame);\r\n    }\r\n    window.requestAnimationFrame(enterFrame);\r\n    window.addEventListener('scroll', () => {\r\n        lastCntr = cntr;\r\n        diff = 0;\r\n        cntr++;\r\n    })\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/scrollEnd.ts","// simple Set\r\nlet cid = 0\r\nexport default class Set {\r\n    private _map: {[cid: number ] : any}\r\n    constructor () {\r\n        this._map = {}\r\n    }\r\n    add (obj: any) {\r\n        obj.__cid__ = cid\r\n        cid++\r\n        this._map[obj.__cid__] = obj\r\n    }\r\n    delete (obj: any) {\r\n        if (obj && obj.__cid__ && this._map.hasOwnProperty(obj.__cid__))\r\n            delete this._map[obj.__cid__]\r\n    }\r\n    forEach (cb: Function) {\r\n        for (let key in this._map) {\r\n            if (this._map.hasOwnProperty(key)) {\r\n                cb (this._map[key])\r\n            }\r\n        }\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/Set.ts"],"sourceRoot":""}