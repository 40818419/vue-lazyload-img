!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Lazyload=t():e.Lazyload=t()}("undefined"!=typeof self?self:this,function(){return function(e){function t(o){if(n[o])return n[o].exports;var r=n[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:o})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=0)}([function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),i=o(r),a=n(2),c=o(a),u=new c.default,s=new c.default;window.addEventListener("scroll",function(e){u.forEach(function(e){e()})},!0),window.addEventListener("scrollEnd",function(e){s.forEach(function(e){e()})},!0);var l=function(e,t,n){var o=e.getBoundingClientRect();(o.bottom>=0&&o.bottom<=window.screen.height||o.top>=0&&o.top<=window.screen.height)&&(o.right>=0&&o.right<=window.screen.width||o.left>=0&&o.left<=window.screen.width)&&e.src!=e.newSrc&&e.newSrc&&(e.src=e.newSrc,e.onload=function(){e.style.opacity="1",e.onload=new Function,u.delete(e.__scrollListener__),s.delete(e.__scrollEndListener__),e.__scrollListener__=null,e.__scrollEndListener__=null},e.style.transition="opacity "+t+"ms",n&&n())},d=function(e){var t=e.lastPos,n=e.lastSpeeds,o=e.aveSpeed,r=document.body.getBoundingClientRect().top,i=t-r;n.length<10?n.push(i):(n.shift(),n.push(i));var a=0;return n.forEach(function(e){a+=e}),o=Math.abs(a/n.length),t=r,{lastPos:t,lastSpeeds:n,aveSpeed:o}},f=function(e,t){return!!e.replace(/^http:/,"").replace(/^https:/,"").match(t.replace(/^http:/,"").replace(/^https:/,""))},p={install:function(e,t){var n=t.time,o=void 0===n?300:n,r=t.fade,a=void 0!==r&&r,c=t.speed,p=void 0===c?0:c;p>0&&(0,i.default)(),e.directive("lazyload",{inserted:function(e,t,n,r){function i(){e.onload=new Function,e.removeEventListener("error",i),u.delete(_),s.delete(w)}if(e&&!f(e.src,t.value)){a&&(e.style.opacity=0),e.src||(e.src="data:image/gifbase64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==");var c={lastPos:document.body.getBoundingClientRect().top,lastSpeeds:[],aveSpeed:0};e.newSrc=t.value;var _=function(){if(e.newSrc&&e.newSrc!==e.src){if(0==p)return void l(e,o);c=d(c),c.aveSpeed>p||l(e,o)}},w=function(){e.newSrc&&e.newSrc!==e.src&&l(e,o)};e.__scrollListener__=_,e.__scrollEndListener__=w,e.onload=function(){e.onload=new Function,e.removeEventListener("error",i),l(e,o),u.add(_),p>0&&s.add(w)},e.addEventListener("error",i)}},update:function(e,t){f(e.src,t.value)||(e.style.opacity=0,e.style.transition="opacity "+o/2+"ms",e.newSrc=t.value,setTimeout(function(){l(e,o/2)},150))}})}};t.default=p},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){function e(){t!==n&&5===++o&&(window.dispatchEvent(r),t=n),requestAnimationFrame(e)}var t=0,n=0,o=0,r=document.createEvent("HTMLEvents");r.initEvent("scrollEnd",!0,!1),r.eventType="message",window.requestAnimationFrame(e),window.addEventListener("scroll",function(){n=t,o=0,t++})},window.requestAnimationFrame||(window.webkitRequestAnimationFrame?window.requestAnimationFrame=window.webkitRequestAnimationFrame:window.requestAnimationFrame=function(e){setTimeout(function(){e()},1e3/60)})},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=0,a=function(){function e(){o(this,e),this._map={}}return r(e,[{key:"add",value:function(e){e.__cid__=i,i++,this._map[e.__cid__]=e}},{key:"delete",value:function(e){e&&e.__cid__&&this._map.hasOwnProperty(e.__cid__)&&delete this._map[e.__cid__]}},{key:"forEach",value:function(e){for(var t in this._map)this._map.hasOwnProperty(t)&&e(this._map[t])}}]),e}();t.default=a}])});